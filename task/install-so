#! /bin/sh

# shellcheck disable=SC2034
THIS_SCRIPT_DESC="Install grammar's shared object"

THIS_SCRIPT=$(readlink -f "$0")
THIS_SCRIPT_DIR=$(dirname "$THIS_SCRIPT")

# shellcheck source=.common
. "${THIS_SCRIPT_DIR}/.common"

########################################################################

CUR_DIR=$(pwd)

cd "${PARSER_PROJ_DIR}" || exit 1

SO_NAME=$("${ATSP_UTIL}"/so-name)

if [ -f "${BUILD_DIR_PATH}/${SO_NAME}" ]; then
  printf "Found shared object, installing.\n"
else
  printf "Failed to find shared object...exiting\n"
  exit 1;
fi

mkdir -p "${SO_INSTALL_DIR}"

printf "* Copying shared object into place\n"

cp "${BUILD_DIR_PATH}/${SO_NAME}" "${SO_INSTALL_DIR}"

printf "  * so name: %s\n" "${SO_NAME}"
printf "  *  source: %s\n" "${BUILD_DIR_PATH}/"
printf "  *    dest: %s\n" "${SO_INSTALL_DIR}/"

cd "${CUR_DIR}" || exit 1

printf "Done\n"
